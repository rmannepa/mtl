create or replace TABLE MATILLION_TRAINING.PUBLIC.SF_ORDERS (
	ROW_ID VARCHAR(16777216),
	ORDER_ID VARCHAR(16777216),
	ORDER_DATE VARCHAR(16777216),
	SHIP_DATE VARCHAR(16777216),
	SHIP_MODE VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	CUSTOMER_NAME VARCHAR(16777216),
	SEGMENT VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CITY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	POSTAL_CODE VARCHAR(16777216),
	REGION VARCHAR(16777216),
	PRODUCT_ID VARCHAR(16777216),
	CATEGORY VARCHAR(16777216),
	SUB_CATEGORY VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	SALES VARCHAR(16777216),
	QUANTITY VARCHAR(16777216),
	DISCOUNT VARCHAR(16777216),
	PROFIT VARCHAR(16777216)
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.SF_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216)
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.SF_RETURNS (
	ORDER_RETURNED VARCHAR(3),
	ORDER_ID VARCHAR(16777216)
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.DIM_PEOPLE (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216),
	INS_DT TIMESTAMP_NTZ(9),
	UPD_DT TIMESTAMP_NTZ(9),
	MTL_RUN_ID INTEGER
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.FILE_LOADING_INFO (
	FILE_NAME VARCHAR(16777216),
	FILE_DELIMITER VARCHAR(16777216),
	SF_TABLE_NAME VARCHAR(16777216)
);

insert into MATILLION_TRAINING.public.file_loading_info values
('ORDERS.txt', '\\t','SF_ORDERS'),
('PEOPLE.txt', ',','SF_PEOPLE'),
('RETURNS.txt', '`~^','SF_RETURNS');

create or replace TABLE MATILLION_TRAINING.PUBLIC.FACT_ORDERS (
	ROW_ID VARCHAR(16777216),
	ORDER_ID VARCHAR(16777216),
	ORDER_DATE VARCHAR(16777216),
	SHIP_DATE VARCHAR(16777216),
	SHIP_MODE VARCHAR(16777216),
	CUSTOMER_ID VARCHAR(16777216),
	CUSTOMER_NAME VARCHAR(16777216),
	SEGMENT VARCHAR(16777216),
	COUNTRY VARCHAR(16777216),
	CITY VARCHAR(16777216),
	STATE VARCHAR(16777216),
	POSTAL_CODE VARCHAR(16777216),
	REGION VARCHAR(16777216),
	PRODUCT_ID VARCHAR(16777216),
	CATEGORY VARCHAR(16777216),
	SUB_CATEGORY VARCHAR(16777216),
	PRODUCT_NAME VARCHAR(16777216),
	SALES VARCHAR(16777216),
	QUANTITY VARCHAR(16777216),
	DISCOUNT VARCHAR(16777216),
	PROFIT VARCHAR(16777216),
	INSERT_TIME TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
	RUN_ID NUMBER(38,0),
	MTL_JOB_NAME VARCHAR(16777216)
);

create or replace TRANSIENT TABLE MATILLION_TRAINING.PUBLIC.STG_DIM_PEOPLE_SCD2 (
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216),
	INDICATOR VARCHAR(1),
	V_START_DATE TIMESTAMP_NTZ(9),
	V_END_DATE TIMESTAMP_NTZ(9)
);

create or replace sequence MATILLION_TRAINING.PUBLIC.SEQ_DIM_PEOPLE_SCD2 start with = 1 increment by 1;

create or replace TABLE MATILLION_TRAINING.PUBLIC.DIM_PEOPLE_SCD2 (
	PEOPLE_SK NUMBER  DEFAULT MATILLION_TRAINING.PUBLIC.SEQ_DIM_PEOPLE_SCD2.NEXTVAL,
	ID NUMBER(38,0),
	PERSON VARCHAR(16777216),
	REGION VARCHAR(16777216),
	START_DATE TIMESTAMP_NTZ(9),
	END_DATE TIMESTAMP_NTZ(9)
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.STG_EMP (
	"emp_no" NUMBER(11,0),
	"first_name" VARCHAR(42),
	"gender" VARCHAR(3),
	"birth_date" DATE,
	"hire_date" DATE
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.TARGET_EMPLOYEES (
	GENDER VARCHAR(3),
	EMP_NO NUMBER(11,0),
	BIRTH_DATE DATE,
	LAST_NAME VARCHAR(48),
	HIRE_DATE DATE,
	FIRST_NAME VARCHAR(42),
	MATILLION_BATCH_ID NUMBER(38,0),
	MATILLION_UPDATED_TIMESTAMP TIMESTAMP_LTZ(9)
);

create or replace TABLE MATILLION_TRAINING.PUBLIC.WEEKLY_EXPENSE_STG (EXPENSE VARIANT);

create or replace TABLE MATILLION_TRAINING.PUBLIC.MTL_JOB_HISTORY (
	PROJECT_ID NUMBER(38,0),
	PROJECT_NAME VARCHAR(16777216),
	ENV_NAME VARCHAR(16777216),
	JOB_ID NUMBER(38,0),
	JOB_NAME VARCHAR(16777216),
	START_TIME TIMESTAMP_NTZ(9),
	END_TIME TIMESTAMP_NTZ(9),
	JOB_STATUS VARCHAR(16777216),
	RUN_ID NUMBER
);
